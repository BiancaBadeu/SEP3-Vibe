@page "/PurchaseHistory"
@inject IReceiptService receiptService
@using global::Shared.DTOs
@using BlazorClient.Services.ClientInterfaces
@using global::Shared
<h3>PurchaseHistory</h3>
@if (receipts == null)
            {
                <span>Loading..</span>
            }
else
{
	<div>
		<BSTable Color="BSColor.Light" IsBordered="true" IsBorderLess="true" IsCaptionTop="true" IsStriped="true">
			<BSTHead>
				<BSTR>
					<BSTD>#Order</BSTD>
					<BSTD>Number of Products</BSTD>
					<BSTD>Date</BSTD>
					<BSTD>Total</BSTD>
				</BSTR>
			</BSTHead>
			<BSTBody>
				@foreach (Receipt receipt in receipts)
				{
					<BSTR AlignRow="AlignRow.Middle">
						<BSTD>@receipt.id</BSTD>
						<BSTD>@receipt.order.items.Count</BSTD>
						<BSTD>@receipt.order.orderDate</BSTD>
						<BSTD>@receipt.finalPrice</BSTD>
					</BSTR>
				}
			</BSTBody>
			<BSTFoot>
				<BSTR>
					<BSTD ColSpan="4">Record of past purchases</BSTD>
				</BSTR>
        
			</BSTFoot>
		</BSTable>
		
		</div>
}
@code {
	private IEnumerable<Receipt>? receipts;
	private string msg = "";
	private long? id= null;

	protected override async Task OnInitializedAsync()
	{
		msg = "";
		try
		{
			receipts = await receiptService.GetAsync();
		}
		catch (Exception e)
		{
			Console.WriteLine(e);
			msg = e.Message;
		}
	}
}